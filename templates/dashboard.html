<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard - ComLabs</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
    :root {
        --primary:#007bff;
        --success:#28a745;
        --danger:#dc3545;
        --warning:#ffc107;
        --gray:#6c757d;
    }

    body {font-family: 'Segoe UI', sans-serif; background:#edf1f7; margin:0; padding:20px; text-align:center;}

    header {
        display:flex; justify-content:space-between; align-items:center;
        background:var(--primary); color:white; padding:18px 45px;
        border-radius:16px; margin-bottom:45px;
        box-shadow:0 6px 25px rgba(0,0,0,0.25);
    }
    header h2 {margin:0; font-size:24px; letter-spacing:0.5px;}

    .menu-buttons {display:flex; gap:12px;}
    .menu-buttons button {
        background:white; color:var(--primary);
        border:none; padding:10px 20px; border-radius:10px;
        cursor:pointer; font-weight:600; transition:0.25s;
        display:flex; align-items:center; gap:8px;
        box-shadow:0 2px 6px rgba(0,0,0,0.15);
    }
    .menu-buttons button:hover {background:#e7f1ff; transform:translateY(-2px);}

    .action-area {margin-bottom: 35px; display:flex; justify-content:center; gap:15px;}
    .action-btn {
        padding:12px 22px; font-weight:600; border-radius:12px; border:none;
        cursor:pointer; transition:0.25s; box-shadow:0 3px 10px rgba(0,0,0,0.18);
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: center;
    }
    .action-btn.add {background:var(--success); color:white;}
    .action-btn.add:hover {background:#1f8a37; transform:translateY(-2px);}
    .action-btn.edit {background:var(--warning); color:white;}
    .action-btn.edit:hover {background:#d13333; transform:translateY(-2px);}

    .grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(260px,1fr)); gap:38px; max-width:1200px; margin:0 auto;}
    .comlab-box {
        background:white; border-radius:18px; padding:32px 20px 85px;
        position:relative; transition:0.35s; box-shadow:0 6px 20px rgba(0,0,0,0.12);
    }
    .comlab-box:hover {transform:translateY(-8px); box-shadow:0 12px 32px rgba(0,0,0,0.22);}

    .comlab-box img {width:75%; margin-bottom:18px; filter:drop-shadow(0 5px 6px rgba(0,0,0,0.18));}
    .comlab-box p {margin:0; font-size:17px; font-weight:600; color:#2b2b2b;}

    .go-btn {
        position:absolute; bottom:18px; left:50%; transform:translateX(-50%);
        padding:10px 20px; background:var(--primary); color:white;
        border:none; border-radius:10px; cursor:pointer; font-weight:600;
        opacity:0; transition:0.35s;
    }
    .comlab-box:hover .go-btn {opacity:1; transform:translate(-50%, -4px);}

    .edit-actions {position:absolute; bottom:18px; left:50%; transform:translateX(-50%); display:flex; gap:10px;}
    .edit-btn {padding:10px; border:none; border-radius:10px; cursor:pointer; font-weight:600; transition:0.25s; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 1.2em;}
    .edit-btn.rename {background:var(--warning);}
    .edit-btn.rename:hover {background:#e6b000;}
    .edit-btn.remove {background:var(--danger); color:white;}
    .edit-btn.remove:hover {background:#b92b36;}
    .edit-btn.cancel {background:var(--gray); color:white;}
    .edit-btn.cancel:hover {background:#555;}
</style>
</head>
<body>

<header>
    <h2>ðŸ’» Computer Laboratory Management</h2>
    <div class="menu-buttons">
        <button onclick="location.href='/dashboard'"><i class="fas fa-home"></i> Dashboard</button>
        <button onclick="location.href='/admins'"><i class="fas fa-user-cog"></i> Admins</button>
        <button onclick="location.href='/users'"><i class="fas fa-user"></i> Users</button>
        <button onclick="location.href='/generate_link'"><i class="fas fa-plus"></i> Add Device</button>
        <button onclick="location.href='/logout'"><i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>
</header>

<div class="action-area">
    <button class="action-btn add" onclick="addLab()"><i class="fas fa-plus"></i> Add Computer Lab</button>
    <button class="action-btn edit" onclick="editLab()"><i class="fas fa-edit"></i> Edit / Remove</button>
</div>

<div class="grid">
{% for lab in labs %}
    <div class="comlab-box">
        <img src="https://its.lmu.edu/media/its/computer%20lab%20icon-400x400.png" alt="{{ lab[1] }}">
        <p>{{ lab[1] }}</p>

        {% if not edit_mode %}
        <button class="go-btn" onclick="location.href='/comlab/{{ lab[0] }}'">Enter Lab â†’</button>
        {% else %}
        <div class="edit-actions">
            <button class="edit-btn rename" onclick="renameLab({{ lab[0] }}, '{{ lab[1] }}')"><i class="fas fa-pencil-alt"></i></button>
            <button class="edit-btn remove" onclick="removeLab({{ lab[0] }})"><i class="fas fa-trash-alt"></i></button>
            <button class="edit-btn cancel" onclick="location.href='/dashboard'"><i class="fas fa-times"></i></button>
        </div>
        {% endif %}
    </div>
{% endfor %}
</div>

<script>
function addLab() {
    const name = prompt("Enter Lab Name:");
    if(!name) return;
    fetch("/add_lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lab_name:name})})
    .then(r=>r.json()).then(d=>{alert(d.message); location.reload();});
}

function editLab(){
    location.href="/dashboard?edit=1";
}

function renameLab(id, currentName){
    const newName = prompt("Rename Lab:", currentName);
    if(!newName || !newName.trim()) return;
    fetch("/rename_lab",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({id:id, new_name:newName})
    }).then(r=>r.json()).then(d=>{alert(d.message); location.reload();});
}

function removeLab(id){
    if(!confirm("Are you sure you want to delete this lab?")) return;
    fetch("/remove_lab",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({id:id})
    }).then(r=>r.json()).then(d=>{alert(d.message); location.reload();});
}
</script>

</body>
</html>